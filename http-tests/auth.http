### 변수 설정
@host = http://localhost:3000
@email = onix-test@test.com
@password = password1234

### 1. 테스트용 사용자 생성
# @name createUser
POST {{host}}/users
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

###
# 참고: 이미 사용자가 존재해서 위 요청이 409 Conflict 에러를 반환해도 괜찮습니다.
# 이 테스트의 목적은 로그인을 위한 사용자가 존재하는 것을 보장하는 것입니다.

### 2. 로그인 성공 테스트
# @name signInSuccess
POST {{host}}/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "{{password}}"
}

> {%
    client.global.set('jwt_token', response.body.access_token);
%}

### 3. 로그인 실패 테스트 (잘못된 비밀번호)
# @name signInFailure
POST {{host}}/auth/login
Content-Type: application/json

{
  "email": "{{email}}",
  "password": "wrongpassword"
}

### 4. 가드 성공 테스트
# Requires a valid JWT token
GET {{host}}/auth/profile
Authorization: Bearer {{jwt_token}}

### 5. 가드 실패 테스트
# No token provived
GET {{host}}/auth/profile